
public class AVLTree {

	private Node rootNode;
	
	public static void main(String[] args) {
		AVLTree tree = new AVLTree();
		int numbers[] = {1,14,27,44,2,-6,110,24,122,90,131,0,123,16,31,84,51};
		for (int i: numbers) {
			
			//TODO: inserir apenas se numero nem intervalo estah na arvore O(n)
			
			tree.insertValue(i);
			
			//TODO: refazer balanceamento (AVL) O(1)
			
		}
		System.out.println("#### inseriu valores ####");
		
		System.out.println(tree.toString(tree.rootNode));
	}

	public void insertValue(int valueToInsert) {
		Node nodeToInsert = new Node (valueToInsert);
		if (rootNode==null) {
			rootNode = nodeToInsert;
		}
		//rootNode existe
		else {
			Node visitingNode = rootNode;
			//percorre a árvore até achar um espaço para inserir
			while (visitingNode!=null) {
				if (valueToInsert<visitingNode.value) {
					if (visitingNode.leftChild!=null) {
						visitingNode = visitingNode.leftChild;
					}
					//encontrou um espaço para inserir
					else {
						visitingNode.leftChild = nodeToInsert;
						nodeToInsert.parent = visitingNode;
						recalculateHeight(nodeToInsert);
						visitingNode = null;
					}
				}
				else {
					if (visitingNode.rightChild!=null) {
						visitingNode = visitingNode.rightChild;
					}
					//encontrou um espaço para inserir
					else {
						visitingNode.rightChild = nodeToInsert;
						nodeToInsert.parent = visitingNode;
						recalculateHeight(nodeToInsert);
						visitingNode = null;
					}
				}				
			}
			
		}
	}
	
	// imprime na ordem que a arvore estaria ordenada
	public String toString (Node node) {
		if (node!=null) {
			toString (node.leftChild);
			System.out.println(node.toString());
			toString (node.rightChild);
			
		} 
		return "";
	}
	
	private void recalculateHeight(Node newNode) {
		int newHeight=0; 
		newNode.height=newHeight;
		Node nodeParent = newNode.parent;
		while (nodeParent!=null){
			newHeight++;
			if (newHeight> nodeParent.height) {
				nodeParent.height++;				
			}
			nodeParent = nodeParent.parent; 
		}
		
	}
	
}

class Node {
	int value;
	int height;
	Node leftChild;
	Node rightChild;
	Node parent;
	
	public Node (int v) {
		this.value=v;
		this.height=0;
		this.leftChild=null;
		this.rightChild=null;
		this.parent=null;
	}
	
	public String toString (){
		return "value = " + value + " height=" +height;
	}
}
